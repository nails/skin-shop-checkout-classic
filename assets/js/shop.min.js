var _nails_skin_shop_checkout_classic;_nails_skin_shop_checkout_classic=function(){return this._checkout_skeuocard=null,this.__construct=function(){var e;e=this.bsCurrentBreakpoint(),$(".nails-shop-skin-checkout-classic.basket").length&&this._basket_init(),$(".nails-shop-skin-checkout-classic.checkout").length&&this._checkout_init(),$(".nails-shop-skin-checkout-classic.processing").length&&this._processing_init()},this._basket_init=function(){$("select[name=shipping_option]").on("change",function(){$(this).closest("form").submit()})},this._checkout_init=function(){$("#checkout-step-1 .panel-footer").removeClass("hidden"),$("#checkout-step-2 .panel-body").hide(),$("#checkout-step-2 .panel-footer").hide(),$("#checkout-step-2 .panel-footer").removeClass("hidden"),$("#checkout-step-3 .panel-body").hide(),$("#checkout-step-3 .panel-footer").hide(),$("#progress-bar").removeClass("hidden"),$("#progress-bar-hr").remove(),this._checkout_set_progress(1),$("#same-billing-address").prop("checked")?$("#billing-address").hide():$("#billing-address").show(),this._checkout_skeuocard=new Skeuocard($("#skeuocard"),{dontFocus:!0});var e=this;$("#checkout-step-1 .panel-footer .action-continue").on("click",function(){return e._checkout_validate_step_1()&&(e._checkout_set_progress(2),$("#checkout-step-2 .panel-body").show(),$("#checkout-step-2 .panel-footer").show(),$("#checkout-step-1 .panel-body").hide(),$("#checkout-step-1 .panel-footer").hide(),$("html, body").scrollTop($("#checkout-step-2").offset().top)),!1}),$("#checkout-step-2 .panel-footer .action-continue").on("click",function(){return e._checkout_validate_step_2()&&(e._checkout_set_progress(3),$("#checkout-step-3 .panel-body").show(),$("#checkout-step-3 .panel-footer").show(),$("#checkout-step-2 .panel-body").hide(),$("#checkout-step-2 .panel-footer").hide(),$("html, body").scrollTop($("#checkout-step-3").offset().top)),!1}),$("#checkout-step-2 .panel-footer .action-back").on("click",function(){return $("#checkout-step-1 .panel-body").show(),$("#checkout-step-1 .panel-footer").show(),$("#checkout-step-2 .panel-body").hide(),$("#checkout-step-2 .panel-footer").hide(),$("#checkout-step-1 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-1 .panel-heading .validate-fail").addClass("hidden"),$("#checkout-step-2 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-2 .panel-heading .validate-fail").addClass("hidden"),$("html, body").scrollTop($("#checkout-step-1").offset().top),e._checkout_set_progress(1),!1}),$("#same-billing-address").on("change",function(){$(this).prop("checked")?$("#billing-address").hide():$("#billing-address").show()}),$("#checkout-step-3 .panel-footer .action-continue").on("click",function(){return e._checkout_validate_step_3()&&($("#progress-bar .progress-bar").attr("data-originaltext",$("#progress-bar .progress-bar").text()).text("Please wait while we get things started...").addClass("active"),$("#progress-bar").addClass("please-wait"),$("#checkout-step-3 .panel-body").hide(),$("#checkout-step-3 .panel-footer").show(function(){switch($("input[name=payment_gateway]:checked").val().toLowerCase()){case"stripe":var e=window.NAILS.SHOP_Checkout_Stripe_publishableKey;Stripe.setPublishableKey(e),Stripe.card.createToken({number:$("#card-form input[name=cc_number]").val(),cvc:$("#card-form input[name=cc_cvc]").val(),exp_month:$("#card-form input[name=cc_exp_month]").val(),exp_year:$("#card-form input[name=cc_exp_year]").val()},function(e,s){if(s.error)$("#checkout-step-3 .panel-body").show(),$("#checkout-step-3 .panel-footer").show(),$("#progress-bar").removeClass("please-wait"),$("#progress-bar .progress-bar").text($("#progress-bar .progress-bar").attr("data-originaltext")).attr("data-originaltext","").removeClass("active"),$("#processing-error").show().find("span").text(s.error.message);else{var a=s.id,t=$("#stripe-hidden-token");if(0===t.length){var r=$("<input>").attr("type","hidden").attr("name","stripe_token").attr("id","stripe-hidden-token");$("#card-form").prepend(r),t=$("#stripe-hidden-token")}t.val(a),$("#card-form input[name=cc_number]").val(""),$("#card-form input[name=cc_cvc]").val(""),$("#card-form input[name=cc_exp_month]").val(""),$("#card-form input[name=cc_exp_year]").val(""),$("#checkout-form").submit()}});break;default:$("#checkout-form").submit()}})),!1}),$("#checkout-step-3 .panel-footer .action-back").on("click",function(){return $("#checkout-step-2 .panel-body").show(),$("#checkout-step-2 .panel-footer").show(),$("#checkout-step-3 .panel-body").hide(),$("#checkout-step-3 .panel-footer").hide(),$("#checkout-step-2 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-2 .panel-heading .validate-fail").addClass("hidden"),$("#checkout-step-3 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-3 .panel-heading .validate-fail").addClass("hidden"),$("html, body").scrollTop($("#checkout-step-2").offset().top),e._checkout_set_progress(2),!1}),$("table.checkout-payment-gateway-layout input").on("click",function(e){e.stopPropagation(),$(this).data("is-redirect")?$("#card-form").removeClass("active"):$("#card-form").addClass("active")}),$("table.checkout-payment-gateway-layout input:checked").trigger("click")},this._checkout_set_progress=function(e){var s=3,a="Step "+e+" of "+s,t=100/s*e;$("#progress-bar .progress-bar").animate({width:t+"%"}).text(a)},this._checkout_validate_step_1=function(){var e=!0,s="";if(s=$("input[name=delivery_address_line_1]").val(),s=$.trim(s),$("input[name=delivery_address_line_1]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=delivery_address_line_1]").next(".help-block").remove(),$("input[name=delivery_address_line_1]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=delivery_address_line_1]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=delivery_address_line_1]").after('<p class="help-block">This field is required.</p>'),$("input[name=delivery_address_line_1]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=delivery_address_town]").val(),s=$.trim(s),$("input[name=delivery_address_town]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=delivery_address_town]").next(".help-block").remove(),$("input[name=delivery_address_town]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=delivery_address_town]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=delivery_address_town]").after('<p class="help-block">This field is required.</p>'),$("input[name=delivery_address_town]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=delivery_address_postcode]").val(),s=$.trim(s),$("input[name=delivery_address_postcode]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=delivery_address_postcode]").next(".help-block").remove(),$("input[name=delivery_address_postcode]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=delivery_address_postcode]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=delivery_address_postcode]").after('<p class="help-block">This field is required.</p>'),$("input[name=delivery_address_postcode]").siblings(".form-control-feedback").removeClass("hidden")),s=$("select[name=delivery_address_country]").val(),s=$.trim(s),$("select[name=delivery_address_country]").closest(".form-group").removeClass("has-error has-feedback"),$("select[name=delivery_address_country]").next(".help-block").remove(),$("select[name=delivery_address_country]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("select[name=delivery_address_country]").closest(".form-group").addClass("has-error has-feedback"),$("select[name=delivery_address_country]").after('<p class="help-block">This field is required.</p>'),$("select[name=delivery_address_country]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=first_name]").val(),s=$.trim(s),$("input[name=first_name]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=first_name]").next(".help-block").remove(),$("input[name=first_name]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=first_name]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=first_name]").after('<p class="help-block">This field is required.</p>'),$("input[name=first_name]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=last_name]").val(),s=$.trim(s),$("input[name=last_name]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=last_name]").next(".help-block").remove(),$("input[name=last_name]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=last_name]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=last_name]").after('<p class="help-block">This field is required.</p>'),$("input[name=last_name]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=telephone]").val(),s=$.trim(s),$("input[name=telephone]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=telephone]").next(".help-block").remove(),$("input[name=telephone]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=telephone]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=telephone]").after('<p class="help-block">This field is required.</p>'),$("input[name=telephone]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=email]").val(),s=$.trim(s),$("input[name=email]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=email]").next(".help-block").remove(),$("input[name=email]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length)e=!1,$("input[name=email]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=email]").after('<p class="help-block">This field is required.</p>'),$("input[name=email]").siblings(".form-control-feedback").removeClass("hidden");else{var a=/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/i;a.test(s)===!1&&(e=!1,$("input[name=email]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=email]").after('<p class="help-block">A valid email must be given.</p>'),$("input[name=email]").siblings(".form-control-feedback").removeClass("hidden"))}return e===!0?($("#checkout-step-1 .panel-heading .validate-ok").removeClass("hidden"),$("#checkout-step-1 .panel-heading .validate-fail").addClass("hidden")):($("#checkout-step-1 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-1 .panel-heading .validate-fail").removeClass("hidden")),e},this._checkout_validate_step_2=function(){var e=!0,s="";return $("#same-billing-address").prop("checked")===!1&&(s=$("input[name=billing_address_line_1]").val(),s=$.trim(s),$("input[name=billing_address_line_1]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=billing_address_line_1]").next(".help-block").remove(),$("input[name=billing_address_line_1]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=billing_address_line_1]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=billing_address_line_1]").after('<p class="help-block">This field is required.</p>'),$("input[name=billing_address_line_1]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=billing_address_town]").val(),s=$.trim(s),$("input[name=billing_address_town]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=billing_address_town]").next(".help-block").remove(),$("input[name=billing_address_town]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=billing_address_town]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=billing_address_town]").after('<p class="help-block">This field is required.</p>'),$("input[name=billing_address_town]").siblings(".form-control-feedback").removeClass("hidden")),s=$("input[name=billing_address_postcode]").val(),s=$.trim(s),$("input[name=billing_address_postcode]").closest(".form-group").removeClass("has-error has-feedback"),$("input[name=billing_address_postcode]").next(".help-block").remove(),$("input[name=billing_address_postcode]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("input[name=billing_address_postcode]").closest(".form-group").addClass("has-error has-feedback"),$("input[name=billing_address_postcode]").after('<p class="help-block">This field is required.</p>'),$("input[name=billing_address_postcode]").siblings(".form-control-feedback").removeClass("hidden")),s=$("select[name=billing_address_country]").val(),s=$.trim(s),$("select[name=billing_address_country]").closest(".form-group").removeClass("has-error has-feedback"),$("select[name=billing_address_country]").next(".help-block").remove(),$("select[name=billing_address_country]").siblings(".form-control-feedback").addClass("hidden"),0===s.replace(/\s/g,"").length&&(e=!1,$("select[name=billing_address_country]").closest(".form-group").addClass("has-error has-feedback"),$("select[name=billing_address_country]").after('<p class="help-block">This field is required.</p>'),$("select[name=billing_address_country]").siblings(".form-control-feedback").removeClass("hidden"))),e===!0?($("#checkout-step-2 .panel-heading .validate-ok").removeClass("hidden"),$("#checkout-step-2 .panel-heading .validate-fail").addClass("hidden")):($("#checkout-step-2 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-2 .panel-heading .validate-fail").removeClass("hidden")),e},this._checkout_validate_step_3=function(){var e=!0,s="";return s=$("input[name=payment_gateway]:checked").val(),s=$.trim(s),$("#payment-gateway-choose-error").addClass("hidden"),$("#payment-card-error").addClass("hidden"),0===s.replace(/\s/g,"").length?(e=!1,$("#payment-gateway-choose-error").removeClass("hidden")):$('input[name="payment_gateway"]:checked').data("is-redirect")||this._checkout_skeuocard.isValid()||(e=!1,$("#payment-card-error").removeClass("hidden")),e===!0?($("#checkout-step-3 .panel-heading .validate-ok").removeClass("hidden"),$("#checkout-step-3 .panel-heading .validate-fail").addClass("hidden")):($("#checkout-step-3 .panel-heading .validate-ok").addClass("hidden"),$("#checkout-step-3 .panel-heading .validate-fail").removeClass("hidden")),e},this._processing_init=function(){var e=this;setTimeout(function(){e._processing_get_status()},250)},this._processing_get_status=function(){var e=$("#processing-container").data("order-ref"),s=this,a={controller:"shop/order",method:"status",data:{ref:e},success:function(e){200===e.status?s._processing_get_status_ok(e):s._processing_get_status_fail(e.error)},error:function(e){var a;try{a=JSON.parse(e.responseText)}catch(t){a={}}var r="string"==typeof a.error?a.error:"";s._processing_get_status_fail(r)}};_nails_api.call(a)},this._processing_get_status_ok=function(e){var s=this;switch($(".order-status-feedback").removeClass("unpaid paid abandoned cancelled failed pending").addClass("processing"),e.order.status){case"UNPAID":$("#thankyou-text").hide(),e.order.is_recent?setTimeout(function(){s._processing_get_status()},750):($(".order-status-feedback").removeClass("processing"),$(".order-status-feedback").addClass(e.order.status.toLowerCase()));break;case"PAID":$(".order-status-feedback").removeClass("processing"),$(".order-status-feedback").addClass(e.order.status.toLowerCase()),$("#thankyou-text").show();break;case"ABANDONED":case"CANCELLED":case"FAILED":case"PENDING":$("#thankyou-text").hide(),$(".order-status-feedback").removeClass("processing"),$(".order-status-feedback").addClass(e.order.status.toLowerCase())}},this._processing_get_status_fail=function(e){$("#processing-error").show().find("span").text(e)},this.bsCurrentBreakpoint=function(){var e=["xs","sm","md","lg"],s=window.document,a=s.createElement("div");s.body.appendChild(a);for(var t=e.length-1;t>=0;t--){var r=e[t];if(a.className="hidden-"+r,null===a.offsetParent)return s.body.removeChild(a),r}return""},this.__construct()};
//# sourceMappingURL=shop.min.js.map
